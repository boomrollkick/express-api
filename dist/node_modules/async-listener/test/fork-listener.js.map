{"version":3,"sources":["../../../../src/node_modules/async-listener/test/fork-listener.js"],"names":["domain","require","process","addAsyncListener","d","create","on","error","send","message","exit","run","server","createServer","listen"],"mappings":"AAAA;;AAEA,IAAIA,SAASC,QAAQ,QAAR,CAAb;;AAEA,IAAI,CAACC,QAAQC,gBAAb,EAA+BF,QAAQ,aAAR;;AAE/B,IAAIG,IAAIJ,OAAOK,MAAP,EAAR;AACAD,EAAEE,EAAF,CAAK,OAAL,EAAc,UAAUC,KAAV,EAAiB;AAC7BL,UAAQM,IAAR,CAAaD,MAAME,OAAnB;AACD,CAFD;;AAIAP,QAAQI,EAAR,CAAW,SAAX,EAAsB,UAAUG,OAAV,EAAmB;AACvC,MAAIA,YAAY,UAAhB,EAA4B;AAC1BP,YAAQQ,IAAR;AACD,GAFD,MAGK;AACHR,YAAQM,IAAR,CAAa,kCAAkCC,OAA/C;AACD;AACF,CAPD;;AASAL,EAAEO,GAAF,CAAM,YAAY;AAChB,MAAIC,SAASX,QAAQ,KAAR,EAAeY,YAAf,EAAb;;AAEAD,SAAON,EAAP,CAAU,OAAV,EAAmB,YAAY;AAC7BJ,YAAQM,IAAR,CAAa,UAAb;AACD,GAFD;;AAIAI,SAAOE,MAAP,CAAc,IAAd,EAAoB,YAAY;AAC9BZ,YAAQM,IAAR,CAAa,gDAAb;AACD,GAFD;AAGD,CAVD","file":"fork-listener.js","sourcesContent":["'use strict';\n\nvar domain = require('domain');\n\nif (!process.addAsyncListener) require('../index.js');\n\nvar d = domain.create();\nd.on('error', function (error) {\n  process.send(error.message);\n});\n\nprocess.on('message', function (message) {\n  if (message === 'shutdown') {\n    process.exit();\n  }\n  else {\n    process.send(\"child got unexpected message \" + message);\n  }\n});\n\nd.run(function () {\n  var server = require('net').createServer();\n\n  server.on('error', function () {\n    process.send('shutdown');\n  });\n\n  server.listen(8585, function () {\n    process.send(\"child shouldn't be able to listen on port 8585\");\n  });\n});\n"]}