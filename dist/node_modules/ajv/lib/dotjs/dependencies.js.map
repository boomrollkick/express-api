{"version":3,"sources":["../../../../../src/node_modules/ajv/lib/dotjs/dependencies.js"],"names":["module","exports","generate_dependencies","it","$keyword","out","$lvl","level","$dataLvl","dataLevel","$schema","schema","$schemaPath","schemaPath","util","getProperty","$errSchemaPath","errSchemaPath","$breakOnError","opts","allErrors","$data","$errs","$it","copy","$closingBraces","$nextValid","$schemaDeps","$propertyDeps","$property","$sch","$deps","Array","isArray","$currentErrorPath","errorPath","arr1","_$property","$i","l1","length","$prop","toQuotedString","jsonPointers","$propertyPath","$missingProperty","_errorDataPathProperty","getPathExpr","$$outStack","push","createErrors","escapeQuotes","join","messages","verbose","__err","pop","compositeRule","async","arr2","$reqProperty","i2","l2","getPath","$currentBaseId","baseId","schemaHasRules","RULES","all","escapeFragment","validate","cleanUpCode"],"mappings":"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","file":"dependencies.js","sourcesContent":["'use strict';\nmodule.exports = function generate_dependencies(it, $keyword) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $schemaDeps = {},\n    $propertyDeps = {};\n  for ($property in $schema) {\n    var $sch = $schema[$property];\n    var $deps = Array.isArray($sch) ? $propertyDeps : $schemaDeps;\n    $deps[$property] = $sch;\n  }\n  out += 'var ' + ($errs) + ' = errors;';\n  var $currentErrorPath = it.errorPath;\n  out += 'var missing' + ($lvl) + ';';\n  for (var $property in $propertyDeps) {\n    $deps = $propertyDeps[$property];\n    out += ' if (' + ($data) + (it.util.getProperty($property)) + ' !== undefined ';\n    if ($breakOnError) {\n      out += ' && ( ';\n      var arr1 = $deps;\n      if (arr1) {\n        var _$property, $i = -1,\n          l1 = arr1.length - 1;\n        while ($i < l1) {\n          _$property = arr1[$i += 1];\n          if ($i) {\n            out += ' || ';\n          }\n          var $prop = it.util.getProperty(_$property);\n          out += ' ( ' + ($data) + ($prop) + ' === undefined && (missing' + ($lvl) + ' = ' + (it.util.toQuotedString(it.opts.jsonPointers ? _$property : $prop)) + ') ) ';\n        }\n      }\n      out += ')) {  ';\n      var $propertyPath = 'missing' + $lvl,\n        $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n      if (it.opts._errorDataPathProperty) {\n        it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, true) : $currentErrorPath + ' + ' + $propertyPath;\n      }\n      var $$outStack = $$outStack || [];\n      $$outStack.push(out);\n      out = ''; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ('dependencies') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { property: \\'' + (it.util.escapeQuotes($property)) + '\\', missingProperty: \\'' + ($missingProperty) + '\\', depsCount: ' + ($deps.length) + ', deps: \\'' + (it.util.escapeQuotes($deps.length == 1 ? $deps[0] : $deps.join(\", \"))) + '\\' } ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'should have ';\n          if ($deps.length == 1) {\n            out += 'property ' + (it.util.escapeQuotes($deps[0]));\n          } else {\n            out += 'properties ' + (it.util.escapeQuotes($deps.join(\", \")));\n          }\n          out += ' when property ' + (it.util.escapeQuotes($property)) + ' is present\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      var __err = out;\n      out = $$outStack.pop();\n      if (!it.compositeRule && $breakOnError) { /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError([' + (__err) + ']); ';\n        } else {\n          out += ' validate.errors = [' + (__err) + ']; return false; ';\n        }\n      } else {\n        out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      }\n    } else {\n      out += ' ) { ';\n      var arr2 = $deps;\n      if (arr2) {\n        var $reqProperty, i2 = -1,\n          l2 = arr2.length - 1;\n        while (i2 < l2) {\n          $reqProperty = arr2[i2 += 1];\n          var $prop = it.util.getProperty($reqProperty),\n            $missingProperty = it.util.escapeQuotes($reqProperty);\n          if (it.opts._errorDataPathProperty) {\n            it.errorPath = it.util.getPath($currentErrorPath, $reqProperty, it.opts.jsonPointers);\n          }\n          out += ' if (' + ($data) + ($prop) + ' === undefined) {  var err =   '; /* istanbul ignore else */\n          if (it.createErrors !== false) {\n            out += ' { keyword: \\'' + ('dependencies') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { property: \\'' + (it.util.escapeQuotes($property)) + '\\', missingProperty: \\'' + ($missingProperty) + '\\', depsCount: ' + ($deps.length) + ', deps: \\'' + (it.util.escapeQuotes($deps.length == 1 ? $deps[0] : $deps.join(\", \"))) + '\\' } ';\n            if (it.opts.messages !== false) {\n              out += ' , message: \\'should have ';\n              if ($deps.length == 1) {\n                out += 'property ' + (it.util.escapeQuotes($deps[0]));\n              } else {\n                out += 'properties ' + (it.util.escapeQuotes($deps.join(\", \")));\n              }\n              out += ' when property ' + (it.util.escapeQuotes($property)) + ' is present\\' ';\n            }\n            if (it.opts.verbose) {\n              out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n            }\n            out += ' } ';\n          } else {\n            out += ' {} ';\n          }\n          out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ';\n        }\n      }\n    }\n    out += ' }   ';\n    if ($breakOnError) {\n      $closingBraces += '}';\n      out += ' else { ';\n    }\n  }\n  it.errorPath = $currentErrorPath;\n  var $currentBaseId = $it.baseId;\n  for (var $property in $schemaDeps) {\n    var $sch = $schemaDeps[$property];\n    if (it.util.schemaHasRules($sch, it.RULES.all)) {\n      out += ' ' + ($nextValid) + ' = true; if (' + ($data) + (it.util.getProperty($property)) + ' !== undefined) { ';\n      $it.schema = $sch;\n      $it.schemaPath = $schemaPath + it.util.getProperty($property);\n      $it.errSchemaPath = $errSchemaPath + '/' + it.util.escapeFragment($property);\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' }  ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += '   ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n"]}