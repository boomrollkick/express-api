"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

Object.defineProperty(exports, "__esModule", { value: true });
var EWMA_1 = require("../EWMA");
var units_1 = require("../units");

var Meter = function Meter(opts) {
    _classCallCheck(this, Meter);

    this.mark = function (n) {
        n = n || 1;
        this._rate.update(n);
    };
    this.val = function () {
        return Math.round(this._rate.rate(this._samples * units_1.default.SECONDS) * 100) / 100;
    };
    var self = this;
    this._samples = opts.samples || opts.seconds || 1;
    this._timeframe = opts.timeframe || 60;
    this._tickInterval = opts.tickInterval || 5 * units_1.default.SECONDS;
    this._rate = new EWMA_1.default(this._timeframe * units_1.default.SECONDS, this._tickInterval);
    if (opts.debug && opts.debug === true) {
        return;
    }
    this._interval = setInterval(function () {
        self._rate.tick();
    }, this._tickInterval);
    this._interval.unref();
};

exports.default = Meter;
//# sourceMappingURL=meter.js.map