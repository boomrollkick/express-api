"use strict";

var pmx_1 = require("./pmx");
var entrypoint_1 = require("./features/entrypoint");
//let io: PMX
var io;
if (process.env.PMX_FORCE_UPDATE) {
    io = new pmx_1.default();
    io.init();
    io.Entrypoint = entrypoint_1.default;
} else {
    // -----------------------------------
    // create a unique, global symbol name
    // -----------------------------------
    var IO_KEY = Symbol.for('@pm2/io');
    // ------------------------------------------
    // check if the global object has this symbol
    // add it if it does not have the symbol, yet
    // ------------------------------------------
    var globalSymbols = Object.getOwnPropertySymbols(global);
    var hasKey = globalSymbols.indexOf(IO_KEY) > -1;
    if (!hasKey) {
        io = global[IO_KEY] = new pmx_1.default();
    }
    if (!hasKey) {
        global[IO_KEY].Entrypoint = entrypoint_1.default;
        // Freeze API, cannot be modified
        //Object.freeze(global[IO_KEY])
    }
    io = global[IO_KEY];
}
module.exports = io;
//# sourceMappingURL=index.js.map