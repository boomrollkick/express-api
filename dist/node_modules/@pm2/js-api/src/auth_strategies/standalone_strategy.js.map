{"version":3,"sources":["../../../../../../src/node_modules/@pm2/js-api/src/auth_strategies/standalone_strategy.js"],"names":["AuthStrategy","require","module","exports","km","cb","_opts","refresh_token","access_token","client_id","auth","retrieveToken","then","res","tokens","data","catch","Error","revoke"],"mappings":";AACA;;;;;;;;;;AAEA,IAAMA,eAAeC,QAAQ,YAAR,CAArB;;AAEAC,OAAOC,OAAP;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,mCACkBC,EADlB,EACsBC,EADtB,EAC0B;AACtB,UAAI,KAAKC,KAAL,CAAWC,aAAX,IAA4B,KAAKD,KAAL,CAAWE,YAA3C,EAAyD;AACvD;AACA,eAAOH,GAAG,IAAH,EAAS;AACdG,wBAAc,KAAKF,KAAL,CAAWE,YADX;AAEdD,yBAAe,KAAKD,KAAL,CAAWC;AAFZ,SAAT,CAAP;AAID,OAND,MAMO,IAAI,KAAKD,KAAL,CAAWC,aAAX,IAA4B,KAAKD,KAAL,CAAWG,SAA3C,EAAsD;AAC3D;AACAL,WAAGM,IAAH,CAAQC,aAAR,CAAsB;AACpBF,qBAAW,KAAKH,KAAL,CAAWG,SADF;AAEpBF,yBAAe,KAAKD,KAAL,CAAWC;AAFN,SAAtB,EAGGK,IAHH,CAGQ,UAACC,GAAD,EAAS;AACf,cAAIC,SAASD,IAAIE,IAAjB;AACA,iBAAOV,GAAG,IAAH,EAASS,MAAT,CAAP;AACD,SAND,EAMGE,KANH,CAMSX,EANT;AAOD,OATM,MASA;AACL;AACA,cAAM,IAAIY,KAAJ,6IAAN;AAED;AACF;AAtBH;AAAA;AAAA,iCAwBgBb,EAxBhB,EAwBoB;AAChB,aAAOA,GAAGM,IAAH,CAAQQ,MAAf;AACD;AA1BH;;AAAA;AAAA,EAA8ClB,YAA9C","file":"standalone_strategy.js","sourcesContent":["\n'use strict'\n\nconst AuthStrategy = require('./strategy')\n\nmodule.exports = class StandaloneFlow extends AuthStrategy {\n  retrieveTokens (km, cb) {\n    if (this._opts.refresh_token && this._opts.access_token) {\n      // if both access and refresh tokens are provided, we are good\n      return cb(null, {\n        access_token: this._opts.access_token,\n        refresh_token: this._opts.refresh_token\n      })\n    } else if (this._opts.refresh_token && this._opts.client_id) {\n      // we can also make a request to get an access token\n      km.auth.retrieveToken({\n        client_id: this._opts.client_id,\n        refresh_token: this._opts.refresh_token\n      }).then((res) => {\n        let tokens = res.data\n        return cb(null, tokens)\n      }).catch(cb)\n    } else {\n      // otherwise the flow isn't used correctly\n      throw new Error(`If you want to use the standalone flow you need to provide either \n        a refresh and access token OR a refresh token and a client id`)\n    }\n  }\n\n  deleteTokens (km) {\n    return km.auth.revoke\n  }\n}\n"]}